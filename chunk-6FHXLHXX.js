import{a as U,b as G,c as z,d as q,e as Y,f as J,g as Q}from"./chunk-Q6YSEL4I.js";import{a as ke}from"./chunk-UYE33M3Y.js";import{a as we}from"./chunk-HFXCUJO7.js";import{a as Ee,b as Te,c as Pe,d as Oe,e as Fe,f as Le,g as Be,h as Ae,i as Ve,j as je,k as Ne}from"./chunk-ZYDK7AQ3.js";import{a as H,b as T}from"./chunk-OBUIYPIE.js";import"./chunk-53D4Q4VK.js";import"./chunk-UOP2MRXY.js";import{a as He}from"./chunk-JKKRUTKQ.js";import"./chunk-SGYCFQGT.js";import{a as O}from"./chunk-4BCJUKHO.js";import{a as Se}from"./chunk-SVXT45U7.js";import"./chunk-PKTJEQ3B.js";import"./chunk-QAGVWGQC.js";import{a as $,b as P,c as I}from"./chunk-CRFRNBQN.js";import{a as xe,e as ve,f as ye,g as Me}from"./chunk-EBI4RQUP.js";import{j as be,n as De,t as Ie,w as Re,y as K}from"./chunk-KONJ5OEV.js";import"./chunk-DI2HMTWA.js";import"./chunk-6XAAMA5M.js";import"./chunk-IMBPNYJZ.js";import"./chunk-NA4IISU4.js";import"./chunk-5A3YSHED.js";import"./chunk-AZWIA2G5.js";import{Cb as V,Db as u,L as se,Mb as r,Md as R,Nb as a,Nd as S,Ob as b,Pb as C,Qb as x,Rc as ge,Sb as k,Sc as he,Tc as E,Ub as h,Vb as d,Yc as Ce,_ as me,_c as D,a as ce,ab as fe,da as de,db as o,dc as j,ec as l,fc as g,gc as p,hc as w,jb as f,nc as ne,oa as v,oc as _e,pa as y,qb as M,qc as c,rc as s,tb as ue,tc as N,wa as pe,wb as _}from"./chunk-YKXOHSBZ.js";function ie(e){switch(e){case"en":return"en-US";case"es":return"es-ES";case"pt":default:return"pt-BR"}}var F=class e{constructor(n){this.i18n=n}map={Completo:"recordStatus.complete",Incompleto:"recordStatus.incomplete"};transform(n){if(!n)return"--";let t=this.map[n];return t?this.i18n.translate.instant(t):n}static \u0275fac=function(t){return new(t||e)(f(O,16))};static \u0275pipe=ue({name:"statusLabel",type:e,pure:!1})};var W=class e{constructor(n,t){this.data=n;this.dialogRef=t}onConfirm(){this.dialogRef.close(!0)}onCancel(){this.dialogRef.close(!1)}static \u0275fac=function(t){return new(t||e)(f(G),f(U))};static \u0275cmp=M({type:e,selectors:[["app-confirm-dialog"]],decls:13,vars:10,consts:[["mat-dialog-title","",1,"confirm-dialog__title"],[1,"confirm-dialog__content"],[1,"confirm-dialog__actions"],["mat-button","",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(t,i){t&1&&(r(0,"h2",0),l(1),c(2,"translate"),a(),r(3,"mat-dialog-content",1)(4,"p"),l(5),a()(),r(6,"mat-dialog-actions",2)(7,"button",3),h("click",function(){return i.onCancel()}),l(8),c(9,"translate"),a(),r(10,"button",4),h("click",function(){return i.onConfirm()}),l(11),c(12,"translate"),a()()),t&2&&(o(),p(" ",s(2,4,"confirmDialog.title"),`
`),o(4),g(i.data.message),o(3),p(" ",s(9,6,"confirmDialog.cancel")," "),o(3),p(" ",s(12,8,"confirmDialog.confirm")," "))},dependencies:[D,I,P,Q,q,J,Y,S,R],styles:[".confirm-dialog__title[_ngcontent-%COMP%]{font-weight:600}.confirm-dialog__content[_ngcontent-%COMP%]{padding:1rem}.confirm-dialog__actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:1rem}"]})};function Qe(e,n){if(e&1&&(C(0),l(1),x()),e&2){let t=d(2);o(),p(" - ",t.record.reason,"")}}function We(e,n){if(e&1){let t=k();C(0),b(1,"input",4)(2,"input",5),c(3,"translate"),r(4,"span",6),l(5),_(6,Qe,2,1,"ng-container",7),l(7,") "),a(),r(8,"button",8),h("click",function(){v(t);let m=d();return y(m.confirmEdit())}),r(9,"mat-icon"),l(10,"check"),a()(),r(11,"button",9),h("click",function(){v(t);let m=d();return y(m.delete())}),r(12,"mat-icon"),l(13,"delete"),a()(),x()}if(e&2){let t,i=d();o(),u("formControl",i.control),o(),u("placeholder",s(3,5,"recordsDetails.messagePlaceholder"))("formControl",i.reasonControl),o(3),p(" (",(t=i.record.origin)!==null&&t!==void 0?t:"----",""),o(),u("ngIf",i.record.reason)}}function Xe(e,n){if(e&1&&(C(0),l(1),x()),e&2){let t=d(2);o(),p(" - ",t.record.reason,"")}}function Ze(e,n){if(e&1){let t=k();r(0,"span",10),l(1),a(),r(2,"span",6),l(3),_(4,Xe,2,1,"ng-container",7),l(5,") "),a(),r(6,"button",8),h("click",function(){v(t);let m=d();return y(m.startEdit())}),r(7,"mat-icon"),l(8,"edit"),a()(),r(9,"button",9),h("click",function(){v(t);let m=d();return y(m.delete())}),r(10,"mat-icon"),l(11,"delete"),a()()}if(e&2){let t,i=d();o(),g(i.control.value||"--:--"),o(2),p(" (",(t=i.record.origin)!==null&&t!==void 0?t:"----",""),o(),u("ngIf",i.record.reason)}}var X=class e{constructor(n,t,i){this.dialog=n;this.snackBar=t;this.i18n=i}form;key;labelKey;icon;record;editing=!1;get control(){return this.form.controls[this.key]}get reasonControl(){let n=`${this.key}Reason`;return this.form.controls[n]}startEdit(){this.editing=!0}confirmEdit(){this.record.time=this.control.value;let n=this.reasonControl.value;this.record.reason=n??void 0,n&&(this.record.origin="Manual"),this.editing=!1,this.snackBar.open(this.i18n.translate.instant("recordsDetails.saved"),this.i18n.translate.instant("manualCheckIn.close"),{duration:3e3,horizontalPosition:"right",verticalPosition:"top",panelClass:["snackbar-success"]})}delete(){this.dialog.open(W,{width:"300px",data:{message:this.i18n.translate.instant("recordsDetails.deleteConfirm")}}).afterClosed().pipe(se()).subscribe(t=>{t&&(this.control.setValue(null),this.reasonControl.setValue(null),this.record.time=null,this.record.origin=null,this.record.reason=void 0,this.editing=!1)})}static \u0275fac=function(t){return new(t||e)(f(z),f(He),f(O))};static \u0275cmp=M({type:e,selectors:[["app-record-details-line"]],inputs:{form:"form",key:"key",labelKey:"labelKey",icon:"icon",record:"record"},decls:7,vars:6,consts:[["read",""],[1,"record-details-line"],[1,"record-details-line__label"],[4,"ngIf","ngIfElse"],["type","time",3,"formControl"],["type","text",3,"placeholder","formControl"],[1,"record-details-line__origin"],[4,"ngIf"],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],[1,"record-details-line__value"]],template:function(t,i){if(t&1&&(r(0,"div",1)(1,"span",2),l(2),c(3,"translate"),a(),_(4,We,14,7,"ng-container",3)(5,Ze,12,3,"ng-template",null,0,N),a()),t&2){let m=j(6);o(2),w("",i.icon," ",s(3,4,i.labelKey),":"),o(2),u("ngIf",i.editing)("ngIfElse",m)}},dependencies:[D,E,K,be,De,Ie,I,$,T,H,S,R],styles:[".record-details-line[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 0;border-bottom:1px solid #e0e0e0}.record-details-line__label[_ngcontent-%COMP%]{min-width:80px;font-weight:500}.record-details-line__value[_ngcontent-%COMP%], .record-details-line__origin[_ngcontent-%COMP%]{font-size:.95rem;color:#555}"]})};function et(e,n){if(e&1&&(r(0,"div",8),b(1,"app-record-details-line",9),a()),e&2){let t=n.$implicit,i=d();o(),u("form",i.form)("record",i.data.records[t.key])("key",t.key)("labelKey",t.label)("icon",t.icon)}}function tt(e,n){if(e&1&&(r(0,"li")(1,"span",13),l(2),a(),r(3,"a",14),l(4),a()()),e&2){let t=n.$implicit;o(2),p("\u{1F4C4} ",t.type,":"),o(),u("href",t.url,fe),V("download",t.fileName),o(),p(" ",t.fileName," ")}}function nt(e,n){if(e&1&&(r(0,"div",10)(1,"p"),l(2),c(3,"translate"),a(),r(4,"ul",11),_(5,tt,5,4,"li",12),a()()),e&2){let t=d();o(2),p("\u{1F4CE} ",s(3,2,"recordsDetails.attachments"),""),o(3),u("ngForOf",t.data.attachments)}}var Z=class e{constructor(n,t,i){this.data=n;this.dialogRef=t;this.fb=i;this.form=this.fb.group({entry:this.fb.control(this.data.records.entry.time??null),entryReason:this.fb.control(this.data.records.entry.reason??null),break:this.fb.control(this.data.records.break.time??null),breakReason:this.fb.control(this.data.records.break.reason??null),return:this.fb.control(this.data.records.return.time??null),returnReason:this.fb.control(this.data.records.return.reason??null),exit:this.fb.control(this.data.records.exit.time??null),exitReason:this.fb.control(this.data.records.exit.reason??null)},{nonNullable:!0})}form;lines=[{key:"entry",icon:"\u{1F552}",label:"quickCheckIn.entry"},{key:"break",icon:"\u2615",label:"records.pause"},{key:"return",icon:"\u{1F501}",label:"quickCheckIn.return"},{key:"exit",icon:"\u{1F6AA}",label:"quickCheckIn.exit"}];cancel(){this.dialogRef.close()}static \u0275fac=function(t){return new(t||e)(f(G),f(U),f(Re))};static \u0275cmp=M({type:e,selectors:[["app-record-details"]],decls:17,vars:19,consts:[["mat-dialog-title",""],[1,"record-details__content"],[1,"record-details__status"],[1,"record-details__balance"],["class","record-details__line",4,"ngFor","ngForOf"],["class","record-details__attachment",4,"ngIf"],["align","end"],["mat-button","",3,"click"],[1,"record-details__line"],[3,"form","record","key","labelKey","icon"],[1,"record-details__attachment"],[1,"record-details__attachment-list"],[4,"ngFor","ngForOf"],[1,"record-details__attachment-type"],[1,"record-details__attachment-link",3,"href"]],template:function(t,i){t&1&&(r(0,"h2",0),l(1),c(2,"translate"),a(),r(3,"mat-dialog-content",1)(4,"p",2),l(5),c(6,"translate"),c(7,"statusLabel"),a(),r(8,"p",3),l(9),c(10,"translate"),a(),_(11,et,2,5,"div",4)(12,nt,6,4,"div",5),a(),r(13,"mat-dialog-actions",6)(14,"button",7),h("click",function(){return i.cancel()}),l(15),c(16,"translate"),a()()),t&2&&(o(),w("\u{1F4C5} ",s(2,9,"recordsDetails.title")," ",i.data.date,""),o(4),w("\u{1F4CC} ",s(6,11,"recordsDetails.status"),": ",s(7,13,i.data.status),""),o(4),w("\u{1F9EE} ",s(10,15,"recordsDetails.balance"),": ",i.data.balance,""),o(2),u("ngForOf",i.lines),o(),u("ngIf",i.data.attachments==null?null:i.data.attachments.length),o(3),g(s(16,17,"manualCheckIn.close")))},dependencies:[D,he,E,K,Q,q,J,Y,T,I,P,S,R,F,X],styles:[".record-details__content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.record-details__status[_ngcontent-%COMP%], .record-details__balance[_ngcontent-%COMP%]{font-weight:500;margin:0}.record-details__line[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 0;border-bottom:1px solid #e0e0e0}.record-details__label[_ngcontent-%COMP%]{min-width:80px;font-weight:500}.record-details__value[_ngcontent-%COMP%], .record-details__origin[_ngcontent-%COMP%]{font-size:.95rem;color:#555}.record-details__attachment[_ngcontent-%COMP%]{margin-top:1rem}.record-details__attachment-list[_ngcontent-%COMP%]{max-height:3.5rem;overflow-y:auto;padding-left:1rem;list-style:none;margin:0}.record-details__attachment-type[_ngcontent-%COMP%]{font-weight:500;margin-right:.25rem}.record-details__attachment-link[_ngcontent-%COMP%]{color:#1976d2;text-decoration:underline;font-weight:500}.record-details__attachment-link[_ngcontent-%COMP%]:hover{text-decoration:none}.record-details__actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:2rem}"]})};var ee=class e{constructor(n){this.http=n}API_URL=ve()?`${ye()}/records`:Me("records");getRecords(){return this.http.get(this.API_URL)}static \u0275fac=function(t){return new(t||e)(de(xe))};static \u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"})};var Ue=()=>["day","entry","pause","return","exit","status","actions"],ot=e=>({records__today:e});function rt(e,n){e&1&&(r(0,"th",20),l(1),c(2,"translate"),a()),e&2&&(o(),g(s(2,1,"records.day")))}function at(e,n){if(e&1&&(r(0,"td",21),l(1),a()),e&2){let t=n.$implicit;u("ngClass",_e(3,ot,t.isToday)),V("id",t.isToday?"today-row":null),o(),p(" ",t.label," ")}}function lt(e,n){e&1&&(r(0,"th",20),l(1),c(2,"translate"),a()),e&2&&(o(),g(s(2,1,"records.entry")))}function ct(e,n){if(e&1&&(r(0,"td",22),l(1),a()),e&2){let t=n.$implicit,i=d(2);o(),p(" ",(i.recordsMap[t.date]==null?null:i.recordsMap[t.date].entry)||"--"," ")}}function st(e,n){e&1&&(r(0,"th",20),l(1),c(2,"translate"),a()),e&2&&(o(),g(s(2,1,"records.pause")))}function mt(e,n){if(e&1&&(r(0,"td",22),l(1),a()),e&2){let t=n.$implicit,i=d(2);o(),p(" ",(i.recordsMap[t.date]==null?null:i.recordsMap[t.date].break)||"--"," ")}}function dt(e,n){e&1&&(r(0,"th",20),l(1),c(2,"translate"),a()),e&2&&(o(),g(s(2,1,"records.return")))}function pt(e,n){if(e&1&&(r(0,"td",22),l(1),a()),e&2){let t=n.$implicit,i=d(2);o(),p(" ",(i.recordsMap[t.date]==null?null:i.recordsMap[t.date].return)||"--"," ")}}function ft(e,n){e&1&&(r(0,"th",20),l(1),c(2,"translate"),a()),e&2&&(o(),g(s(2,1,"records.exit")))}function ut(e,n){if(e&1&&(r(0,"td",22),l(1),a()),e&2){let t=n.$implicit,i=d(2);o(),p(" ",(i.recordsMap[t.date]==null?null:i.recordsMap[t.date].exit)||"--"," ")}}function _t(e,n){e&1&&(r(0,"th",20),l(1),c(2,"translate"),a()),e&2&&(o(),g(s(2,1,"records.status")))}function gt(e,n){if(e&1&&(r(0,"td",22),l(1),c(2,"statusLabel"),a()),e&2){let t=n.$implicit,i=d(2);o(),p(" ",s(2,1,i.recordsMap[t.date]==null?null:i.recordsMap[t.date].status)," ")}}function ht(e,n){e&1&&(r(0,"th",20),l(1),c(2,"translate"),a()),e&2&&(o(),g(s(2,1,"records.actions")))}function Ct(e,n){if(e&1){let t=k();r(0,"td",22)(1,"button",23),h("click",function(){v(t);let m=d(2);return y(m.handleViewDetails())}),l(2),c(3,"translate"),a()()}e&2&&(o(2),g(s(3,1,"records.viewDetails")))}function xt(e,n){e&1&&b(0,"tr",24)}function vt(e,n){e&1&&b(0,"tr",25)}function yt(e,n){if(e&1&&(C(0),r(1,"div",6)(2,"table",7),C(3,8),_(4,rt,3,3,"th",9)(5,at,2,5,"td",10),x(),C(6,11),_(7,lt,3,3,"th",9)(8,ct,2,1,"td",12),x(),C(9,13),_(10,st,3,3,"th",9)(11,mt,2,1,"td",12),x(),C(12,14),_(13,dt,3,3,"th",9)(14,pt,2,1,"td",12),x(),C(15,15),_(16,ft,3,3,"th",9)(17,ut,2,1,"td",12),x(),C(18,16),_(19,_t,3,3,"th",9)(20,gt,3,3,"td",12),x(),C(21,17),_(22,ht,3,3,"th",9)(23,Ct,4,3,"td",12),x(),_(24,xt,1,0,"tr",18)(25,vt,1,0,"tr",19),a()(),x()),e&2){let t=d();o(2),u("dataSource",t.daysInMonth),o(22),u("matHeaderRowDef",ne(3,Ue)),o(),u("matRowDefColumns",ne(4,Ue))}}function Mt(e,n){e&1&&b(0,"app-shimmer",26),e&2&&u("rowsCount",4)}var Ge=class e{constructor(n,t,i,m,B){this.headerService=n;this.dialog=t;this.recordsService=i;this.i18n=m;this.destroyRef=B;this.headerService.setTitle(this.i18n.translate.instant("recordsPage.title",{month:this.formattedMonth}))}currentMonth=new Date;recordsMap={};isLoading=!0;get formattedMonth(){let n=ie(this.i18n.translate.currentLang);return this.currentMonth.toLocaleDateString(n,{month:"long",year:"numeric"})}daysInMonth=[];langSub;buildAttachments(n){let t={fileName:"atestado.pdf",url:"https://example.com/atestado.pdf",type:"Atestado"};return Array.from({length:n},()=>ce({},t))}ngOnInit(){this.langSub=this.i18n.translate.onLangChange.subscribe(n=>{this.headerService.setTitle(this.i18n.translate.instant("recordsPage.title",{month:this.formattedMonth})),this.generateDaysForMonth()}),this.generateDaysForMonth(),this.recordsService.getRecords().pipe(Se(this.destroyRef)).subscribe(n=>{this.recordsMap={};for(let t of n)this.recordsMap[t.date]=t;this.isLoading=!1})}ngAfterViewInit(){setTimeout(()=>{let n=document.querySelector(".records__today");n&&n.scrollIntoView({behavior:"smooth",block:"center"})},0)}prevMonth(){this.currentMonth=new Date(this.currentMonth.getFullYear(),this.currentMonth.getMonth()-1,1),this.headerService.setTitle(this.i18n.translate.instant("recordsPage.title",{month:this.formattedMonth})),this.generateDaysForMonth()}nextMonth(){this.currentMonth=new Date(this.currentMonth.getFullYear(),this.currentMonth.getMonth()+1,1),this.headerService.setTitle(this.i18n.translate.instant("recordsPage.title",{month:this.formattedMonth})),this.generateDaysForMonth()}handleViewDetails(){this.dialog.open(Z,{width:"600px",data:{date:"24/03/2025",status:"Completo",balance:"+00:47",records:{entry:{type:"Entrada",time:"08:00",origin:"Autom\xE1tico"},break:{type:"Pausa",time:"12:00",origin:"Autom\xE1tico"},return:{type:"Retorno",time:"13:00",origin:"Manual",reason:"Reuni\xE3o externa"},exit:{type:"Sa\xEDda",time:"18:00",origin:"Autom\xE1tico"}},attachments:this.buildAttachments(9)}})}generateDaysForMonth(){let n=this.currentMonth.getFullYear(),t=this.currentMonth.getMonth(),i=new Date(n,t+1,0).getDate(),m=new Date;this.daysInMonth=[];let B=ie(this.i18n.translate.currentLang);for(let A=1;A<=i;A++){let te=new Date(n,t,A),ze=m.toDateString()===te.toDateString(),qe=te.toLocaleDateString(B,{weekday:"short"});this.daysInMonth.push({label:`${qe} - ${String(A).padStart(2,"0")}`,isToday:ze,date:te.toISOString().substring(0,10)})}}ngOnDestroy(){this.langSub?.unsubscribe()}static \u0275fac=function(t){return new(t||e)(f(ke),f(z),f(ee),f(O),f(pe))};static \u0275cmp=M({type:e,selectors:[["app-records"]],decls:14,vars:5,consts:[["loading",""],[1,"records"],[1,"records__header"],["mat-icon-button","",3,"click"],[1,"records__month"],[4,"ngIf","ngIfElse"],[1,"records__table-container"],["mat-table","",1,"records__table",3,"dataSource"],["matColumnDef","day"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"ngClass",4,"matCellDef"],["matColumnDef","entry"],["mat-cell","",4,"matCellDef"],["matColumnDef","pause"],["matColumnDef","return"],["matColumnDef","exit"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",3,"ngClass"],["mat-cell",""],["mat-button","",3,"click"],["mat-header-row",""],["mat-row",""],["type","list",3,"rowsCount"]],template:function(t,i){if(t&1){let m=k();r(0,"div",1)(1,"div",2)(2,"button",3),h("click",function(){return v(m),y(i.prevMonth())}),r(3,"mat-icon"),l(4,"chevron_left"),a()(),r(5,"span",4),l(6),c(7,"titlecase"),a(),r(8,"button",3),h("click",function(){return v(m),y(i.nextMonth())}),r(9,"mat-icon"),l(10,"chevron_right"),a()()(),_(11,yt,26,5,"ng-container",5)(12,Mt,1,1,"ng-template",null,0,N),a()}if(t&2){let m=j(13);o(6),g(s(7,3,i.formattedMonth)),o(5),u("ngIf",!i.isLoading)("ngIfElse",m)}},dependencies:[D,ge,E,Ce,Ne,Ee,Pe,Be,Oe,Te,Ae,Fe,Le,Ve,je,I,P,$,T,H,S,R,F,we],styles:[".records[_ngcontent-%COMP%]{padding:2rem}.records__header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:1rem;margin-bottom:2rem}.records__header[_ngcontent-%COMP%]   .records__month[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:600}.records__table-container[_ngcontent-%COMP%]{overflow-x:auto}.records__table[_ngcontent-%COMP%]{width:100%;min-width:800px}.records__table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;background-color:#f5f5f5}.records__table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .records__table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:1rem;text-align:center}.records__today[_ngcontent-%COMP%]{background-color:#e3f2fd;font-weight:700}.records__scroll-container[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto}"]})};export{Ge as RecordsComponent};
